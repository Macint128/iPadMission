<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>6í•™ë…„ ë£¨í‹´ ë§ˆìŠ¤í„° - ì§€ì¶œ í¸ì§‘ & ì„¸ë¡œ ë°°ì¹˜</title>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
<style>
    /* [ë ˆì´ì•„ì›ƒ: ëª¨ë“  ì¹´ë“œ ì„¸ë¡œ ë°°ì¹˜] */
    body { font-family: 'Malgun Gothic', sans-serif; background-color: #f0f4f7; padding: 15px; color: #2c3e50; line-height: 1.4; margin: 0; }
    h1 { text-align: center; color: #37474f; margin: 20px 0; font-size: 1.8em; }
    
    .container { max-width: 600px; margin: 0 auto; display: flex; flex-direction: column; gap: 20px; } /* ì„¸ë¡œ ë°°ì¹˜ í•µì‹¬ */

    .card { background: white; border-radius: 25px; padding: 22px; box-shadow: 0 8px 20px rgba(0,0,0,0.06); border-top: 8px solid #546e7a; position: relative; }
    
    /* [ê°ì • ë²„ë¸”] */
    .ai-bubble { background: #37474f; color: white; padding: 18px; border-radius: 20px; margin-bottom: 20px; font-size: 1em; position: relative; font-weight: bold; }
    .ai-bubble::after { content: ''; position: absolute; bottom: -10px; left: 30px; border-width: 10px 10px 0; border-style: solid; border-color: #37474f transparent; }
    
    .emo-good { background: #00897b !important; } .emo-good::after { border-color: #00897b transparent; }
    .emo-warn { background: #fbc02d !important; color: #000 !important; } .emo-warn::after { border-color: #fbc02d transparent; }
    .emo-angry { background: #d32f2f !important; animation: shake 0.3s infinite; } .emo-angry::after { border-color: #d32f2f transparent; }
    .emo-broken { background: #212121 !important; color: #ff5252 !important; border: 2px solid #ff1744; } .emo-broken::after { border-color: #212121 transparent; }

    /* [ê¸°ë¡ ë¦¬ìŠ¤íŠ¸ & í¸ì§‘] */
    .history-log { max-height: 200px; overflow-y: auto; background: #fafafa; border-radius: 15px; padding: 10px; border: 1px solid #eee; margin-top: 10px; }
    .log-item { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #eee; font-size: 0.85em; }
    .log-btns button { border: none; background: none; cursor: pointer; font-size: 1em; margin-left: 5px; opacity: 0.6; }
    .log-btns button:hover { opacity: 1; }

    /* [ì¼ì • ìŠ¬ë¡¯] */
    .slot { display: flex; margin-bottom: 5px; padding: 7px 10px; background: #f8f9fa; border-radius: 8px; font-size: 0.82em; align-items: center; border-left: 4px solid #cfd8dc; }
    .time { width: 95px; font-weight: bold; color: #546e7a; flex-shrink: 0; }
    .morning-slot { background: #fff3e0 !important; border-left-color: #ff9800; }
    .homework-slot { background: #fff9c4 !important; border-left-color: #fbc02d; }
    .game-slot { background: #dcedc8 !important; border-left-color: #7cb342; }

    /* [DOS í™”ë©´] */
    #dosScreen { display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: #000; color: #00ff00; font-family: 'Courier New', monospace; padding: 40px; box-sizing: border-box; z-index: 9999; }
    
    @keyframes shake { 0%, 100% { transform: translate(0,0); } 25% { transform: translate(2px, 2px); } 75% { transform: translate(-2px, -2px); } }
    .btn-main { background: #37474f; color: white; border: none; width: 100%; padding: 12px; border-radius: 12px; font-weight: bold; cursor: pointer; margin-top: 10px; }
</style>
</head>
<body onload="initApp()">

    <div id="dosScreen">
        <div>[SYSTEM FATAL ERROR]</div>
        > <span id="dosMessage"></span><span style="display:inline-block; width:10px; height:20px; background:#00ff00;"></span>
    </div>

    <h1>ğŸ“Š 6í•™ë…„ ë£¨í‹´ ë§ˆìŠ¤í„°</h1>

    <div class="container">
        <div class="card" style="border-top-color: #00897b;">
            <div id="aiBubble" class="ai-bubble">ê¸°ë¡ì„ ê¸°ë‹¤ë¦¬ê³  ìˆì–´ìš”! ğŸ</div>
            <div style="text-align: center; margin-bottom: 10px;">
                <span id="balanceDisplay" style="font-size: 2.5em; font-weight: 900; color: #00695c;">0 ì›</span>
            </div>
            <div class="history-log" id="historyLog"></div>
            <button class="btn-main" onclick="openModal()">ğŸ’° ê¸°ë¡ ë° í¸ì§‘</button>
        </div>

        <div class="card" style="border-top-color: #03a9f4;">
            <div style="font-weight:bold; margin-bottom:10px;">ğŸ¯ iPad ëª©í‘œ í˜„í™©</div>
            <div id="wishGrid" style="display:grid; grid-template-columns: repeat(4, 1fr); gap:10px; margin-bottom:15px;"></div>
            <div style="background:#eee; height:12px; border-radius:6px; overflow:hidden;">
                <div id="totalBar" style="background:#03a9f4; height:100%; width:0%; transition:0.5s;"></div>
            </div>
        </div>

        <div id="scheduleContainer" style="display:contents;"></div>
    </div>

    <div id="moneyModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); z-index:1000; justify-content:center; align-items:center;">
        <div style="background:white; padding:25px; border-radius:20px; width:300px;">
            <h3 id="modalTitle" style="text-align:center; margin-top:0;">ê¸°ë¡ ê´€ë¦¬</h3>
            <input type="hidden" id="editIndex" value="-1">
            <input type="text" id="moneyNote" style="width:100%; padding:10px; margin-bottom:10px; border-radius:8px; border:1px solid #ccc; box-sizing:border-box;" placeholder="ë‚´ìš© (ì˜ˆ: ìš©ëˆ, ê³¼ìì°¸ìŒ)">
            <input type="number" id="moneyAmount" style="width:100%; padding:10px; margin-bottom:15px; border-radius:8px; border:1px solid #ccc; box-sizing:border-box;" placeholder="ê¸ˆì•¡ (ì§€ì¶œì€ - ì…ë ¥)">
            <button class="btn-main" onclick="saveRecord()">ì €ì¥í•˜ê¸°</button>
            <button onclick="closeModal()" style="width:100%; margin-top:10px; background:none; border:none; color:gray; cursor:pointer;">ì·¨ì†Œ</button>
        </div>
    </div>

    <script>
        let appData = { balance: 0, logs: [], bought: [] };
        const SCRIPTS = {
            SAVE: ["ğŸ–ï¸ ì €ì¶•ì™• ì¤€í˜¸ë‹˜!", "âœ¨ ëª©í‘œê°€ ê°€ê¹Œì›Œì¡Œì–´ìš”!", "ğŸ‘ ëŒ€ë‹¨í•œ ì ˆì•½ì •ì‹ ì´ì—ìš”!"],
            SPEND: ["ğŸ­ ì‹¤ìˆ˜í•  ìˆ˜ë„ ìˆì£ !", "ğŸ’¢ ë­ì•¼! ì™œê·¸ë˜!!", "ğŸ’€ ì´ë²ˆìƒì—” ê¸€ë €ë„¤...", "ğŸ’” ì‹œìŠ¤í…œ íŒŒê´´ ì¤‘..."],
            DOS: ["ì „ì¬ì‚°ì„... í•œ ë²ˆì—...? ì´ê±´ ì‚´ì¸ì´ì—ìš”.", "0ì›ì„ ìœ„í•´ ì œê°€ ì¡´ì¬í•  ì´ìœ ëŠ” ì—†ìŠµë‹ˆë‹¤."]
        };

        function initApp() {
            const saved = localStorage.getItem('junho_v6_final');
            if (saved) appData = JSON.parse(saved);
            renderWishlist();
            renderSchedule();
            updateUI();
        }

        function updateUI() {
            document.getElementById('balanceDisplay').innerText = appData.balance.toLocaleString() + " ì›";
            const p = Math.min(100, (appData.balance / 1000000) * 100);
            document.getElementById('totalBar').style.width = p + "%";

            document.getElementById('historyLog').innerHTML = appData.logs.map((l, i) => `
                <div class="log-item">
                    <span>${l.note}</span>
                    <span style="font-weight:bold; color:${l.amount>=0?'#2e7d32':'#d32f2f'}">${l.amount.toLocaleString()}</span>
                    <div class="log-btns">
                        <button onclick="editLog(${i})">âœï¸</button>
                        <button onclick="deleteLog(${i})">âŒ</button>
                    </div>
                </div>
            `).join('') || '<p style="text-align:center; color:#999; font-size:0.8em;">ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</p>';

            processEmotion();
            localStorage.setItem('junho_v6_final', JSON.stringify(appData));
        }

        function processEmotion() {
            const bubble = document.getElementById('aiBubble');
            bubble.className = "ai-bubble";
            if (appData.logs.length === 0) return;
            const last = appData.logs[0];
            if (last.amount >= 0) {
                bubble.classList.add('emo-good');
                bubble.innerText = SCRIPTS.SAVE[Math.floor(Math.random()*SCRIPTS.SAVE.length)];
            } else {
                const a = Math.abs(last.amount);
                if (a >= 80000) { bubble.classList.add('emo-broken'); bubble.innerText = SCRIPTS.SPEND[3]; }
                else if (a >= 50000) { bubble.classList.add('emo-angry'); bubble.innerText = SCRIPTS.SPEND[2]; }
                else { bubble.classList.add('emo-warn'); bubble.innerText = SCRIPTS.SPEND[0]; }
            }
        }

        function openModal() {
            document.getElementById('modalTitle').innerText = "ğŸ’° ìƒˆ ê¸°ë¡ ì¶”ê°€";
            document.getElementById('editIndex').value = "-1";
            document.getElementById('moneyNote').value = "";
            document.getElementById('moneyAmount').value = "";
            document.getElementById('moneyModal').style.display='flex';
        }

        function editLog(i) {
            const log = appData.logs[i];
            document.getElementById('modalTitle').innerText = "âœï¸ ê¸°ë¡ ìˆ˜ì •";
            document.getElementById('editIndex').value = i;
            document.getElementById('moneyNote').value = log.note;
            document.getElementById('moneyAmount').value = log.amount;
            document.getElementById('moneyModal').style.display='flex';
        }

        function deleteLog(i) {
            if(confirm("ì´ ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                appData.balance -= appData.logs[i].amount;
                appData.logs.splice(i, 1);
                updateUI();
            }
        }

        function saveRecord() {
            const idx = parseInt(document.getElementById('editIndex').value);
            const note = document.getElementById('moneyNote').value || "ì¼ë°˜";
            const amt = parseInt(document.getElementById('moneyAmount').value);
            if (isNaN(amt)) return;

            // ì „ì¬ì‚° íƒ•ì§„ ì²´í¬ (ì§€ì¶œì¼ ë•Œë§Œ)
            if (amt < 0 && Math.abs(amt) >= appData.balance && appData.balance > 0) {
                appData.balance = 0;
                appData.logs.unshift({ note: "ì „ì¬ì‚° íƒ•ì§„", amount: amt });
                updateUI(); triggerDos(); return;
            }

            if (idx === -1) {
                appData.balance += amt;
                appData.logs.unshift({ note, amount: amt });
            } else {
                appData.balance = appData.balance - appData.logs[idx].amount + amt;
                appData.logs[idx] = { note, amount: amt };
            }
            updateUI(); closeModal();
        }

        function triggerDos() {
            document.getElementById('dosScreen').style.display = 'block';
            let msg = SCRIPTS.DOS[Math.floor(Math.random()*SCRIPTS.DOS.length)];
            let i = 0;
            function typing() {
                if (i < msg.length) {
                    document.getElementById('dosMessage').innerHTML += msg.charAt(i);
                    i++; setTimeout(typing, 100);
                }
            }
            typing();
        }

        function renderWishlist() {
            const items = ["ğŸ“±", "ğŸ–‹ï¸", "ğŸ’¼", "ğŸ“"];
            document.getElementById('wishGrid').innerHTML = items.map(icon => `
                <div style="background:#f8f9fa; border-radius:10px; text-align:center; padding:10px; font-size:1.5em;">${icon}</div>
            `).join('');
        }

        function renderSchedule() {
            const m = [{t:'07:25-08:15', task:'â° ê¸°ìƒ/ì¤€ë¹„', s:'morning-slot'}];
            const e = [{t:'21:30-21:50', task:'ğŸª¥ ì·¨ì¹¨ ì¤€ë¹„'}, {t:'21:50-07:25', task:'ğŸ’¤ ìˆ™ë©´'}];
            const weekly = [
                { title: "ì›”Â·ëª© ë£¨í‹´", s: [...m, {t:'08:15-14:20', task:'ğŸ« í•™êµ ìƒí™œ'}, {t:'14:35-15:05', task:'âœï¸ ìˆ˜í•™ ìˆ™ì œ', s:'homework-slot'}, {t:'15:05-15:35', task:'ğŸ® Ryujinx', s:'game-slot'}, {t:'18:30-19:00', task:'ğŸš¿ ìƒ¤ì›Œ'}, ...e]},
                { title: "í™”ìš”ì¼", s: [...m, {t:'16:00-18:00', task:'ğŸ’» ì½”ë”© í•™ì›', s:'homework-slot'}, ...e]},
                { title: "ìˆ˜ìš”ì¼", s: [...m, {t:'13:00-14:00', task:'ğŸ”¤ ì˜ì–´ ê³¼ì™¸', s:'homework-slot'}, ...e]},
                { title: "ì¼ìš”ì¼", s: [{t:'09:00-12:00', task:'âš ï¸ ìˆ™ì œ ì •ì‚°', s:'urgent-slot'}, {t:'13:00-18:30', task:'ğŸ® ììœ  ê²Œì„', s:'game-slot'}, {t:'19:00-20:00', task:'ğŸ± ì¼ìš” ë§Œì°¬'}, ...e]}
            ];
            document.getElementById('scheduleContainer').innerHTML = weekly.map(day => `
                <div class="card">
                    <div style="font-weight:900; margin-bottom:12px; font-size:1.1em; border-bottom:1px solid #eee; padding-bottom:5px;">${day.title}</div>
                    ${day.s.map(slot => `<div class="slot ${slot.s || ''}"><span class="time">${slot.t}</span><span>${slot.task}</span></div>`).join('')}
                </div>
            `).join('');
        }

        function closeModal() { document.getElementById('moneyModal').style.display='none'; }
    </script>
</body>
</html>